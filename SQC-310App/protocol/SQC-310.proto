#terminator = CR LF;
Terminator = ;
#OutTerminator = CR LF;
#InTerminator = CR LF;

# Length: Command length + 34 | Command length + 0x22 | 1:#, 2:$, 3:%, 4:&, 5:', 6:(, etc

SYNC = "!";

get_device_name {
    # Example: !#@O7 -> !8ASQC310C 2MB Ver 6.65Zï¿½ (Response CRC2 is non-printable)
    LEN = 0x23; CMD = "@"; CRC1 = 0x4F; CRC2 = 0x37;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A", "%s", "\?\?";
    ExtraInput = Ignore;  # Just read the first section and ignore the rest
}

get_material_density {
    LEN = 0x27; CMD = "F\$1? 2"; CRC1 = 0x47; CRC2 = 0x69;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A", "%f", "\?\?"
}

set_material_density {
    # Example Command: F1 1,55.55
    # Left and right pad with zeroes so we can hard-code the width
    LEN = 0x2C; CMD = "F\$1 2,%05.2f"; CRC1 = 0x0; CRC2 = 0x0;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A", "\?\?"
}

get_crystal_tooling {
    # Parameter: Sensor number
    LEN = 0x28; CMD = "HA1? \$1"; CRC1 = 0x0; CRC2 = 0x0;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A\$1,", "%d", " ", "\?\?"
}

set_crystal_tooling {
    # Parameters: Sensor Number
    # Example: HA1 1,010
    # Left pad with zeroes so we can hard-code the width
    LEN = 0x2B; CMD = "HA1 \$1,%03d"; CRC1 = 0x0; CRC2 = 0x0;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A", "\?\?"
}

get_rate {
    # Parameter: Sensor number
    LEN = 0x24; CMD = "L\$1"; CRC1 = 0x0; CRC2 = 0x0;
    # Full request (Sensor 1): !$L1f2
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    # Full response: !)A 0.00Wd
    in $SYNC, "\?A", "%f", "\?\?";
}

get_thickness {
    # Parameter: Sensor number
    LEN = 0x24; CMD = "N\$1"; CRC1 = 0x0; CRC2 = 0x0;
    # Full request (Sensor 1): !$N1]Q
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    # Full response: !*A 0.000Z\
    in $SYNC, "\?A", "%f", "\?\?";
}

get_frequency1 {
    LEN = 0x24; CMD = "P1"; CRC1 = 0x5A; CRC2 = 0x91;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A", "% f", "\?\?";
}

get_shutter {
    LEN = 0x24; CMD = "U?"; CRC1 = 0x5B; CRC2 = 0x54;
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    in $SYNC, "\?A", "% f", "\?\?";
}

#get_filmParameters {
#    LEN = 0x25; CMD = "A1?"; CRC1 = 0x2E; CRC2 = 0x95;
#    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
#    #in $SYNC, "\?A", "%#s%", , "%(\$1.VAL)f", "*f", "%(\$2.VAL)f", "%*f", "%*f", "%*d". "%*d", "\?\?";
#    in $SYNC, "\?A", "\?\?";
#}

zero_thickness {
    LEN = "0x25"; CMD = "U32"; CRC1 = 0x94; CRC2 = 0x53;
    # Full request:
    out $SYNC, $LEN, $CMD, $CRC1, $CRC2;
    # Full response:
    in $SYNC, "\?A", "\?\?";
}
